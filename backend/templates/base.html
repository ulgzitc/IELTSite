{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Prep - Django Template</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Noto Sans', sans-serif; }
        
        /* Custom Scrollbar for Test Interface */
        .test-scroll::-webkit-scrollbar { width: 8px; }
        .test-scroll::-webkit-scrollbar-track { background: #f1f1f1; }
        .test-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .test-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Dropdown Animation */
        .group:hover .group-hover\:block { display: block; animation: fadeIn 0.2s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Exam States */
        .q-btn.active { background-color: #1d4ed8; color: white; border-color: #1d4ed8; }
        .q-btn.answered { background-color: #dbeafe; color: #1e40af; border-color: #1e40af; font-weight: bold; }
        .q-btn.flagged { border-color: #f59e0b; color: #f59e0b; position: relative; }
        .q-btn.flagged::after { content: ''; position: absolute; top: 2px; right: 2px; width: 6px; height: 6px; background: #f59e0b; border-radius: 50%; }

        /* Progress Circle (CSS only) */
        .progress-circle {
            width: 100px; height: 100px; border-radius: 50%;
            background: radial-gradient(closest-side, white 79%, transparent 80% 100%),
            conic-gradient(#3b82f6 75%, #e5e7eb 0);
        }
    </style>
</head>
<body class="bg-gray-50 flex flex-col min-h-screen text-slate-800">

    <!-- ================================================================================== -->
    <!-- DJANGO TEMPLATE: base.html (NAVBAR) -->
    <!-- ================================================================================== -->
    <nav class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <!-- Logo -->
                <div class="flex items-center cursor-pointer" onclick="app.router.navigate('home')">
                    <i class="fa-solid fa-layer-group text-3xl text-blue-700 mr-2"></i>
                    <div>
                        <span class="font-bold text-xl text-blue-900">IELTS<span class="text-blue-600">Pro</span></span>
                    </div>
                </div>

                <!-- Desktop Menu with Dropdowns -->
                <div class="hidden md:flex items-center space-x-1">
                    
                    <!-- Listening Dropdown -->
                    <div class="relative group h-full flex items-center px-3">
                        <button class="text-gray-600 group-hover:text-blue-700 font-medium flex items-center gap-1 h-full">
                            Listening <i class="fa-solid fa-chevron-down text-[10px] opacity-50"></i>
                        </button>
                        <div class="hidden group-hover:block absolute top-16 left-0 w-56 bg-white shadow-lg rounded-b-lg border-t-2 border-blue-600 py-2">
                            <a href="#" onclick="app.router.navigate('list', 'listening')" class="block px-4 py-2 hover:bg-blue-50 text-sm text-gray-700">Mock Tests (Vol 1-19)</a>
                            <a href="#" class="block px-4 py-2 hover:bg-blue-50 text-sm text-gray-700">Sectional Practice</a>
                            <a href="#" class="block px-4 py-2 hover:bg-blue-50 text-sm text-gray-700">Tips & Tricks</a>
                        </div>
                    </div>

                    <!-- Reading Dropdown -->
                    <div class="relative group h-full flex items-center px-3">
                        <button class="text-gray-600 group-hover:text-blue-700 font-medium flex items-center gap-1 h-full">
                            Reading <i class="fa-solid fa-chevron-down text-[10px] opacity-50"></i>
                        </button>
                        <div class="hidden group-hover:block absolute top-16 left-0 w-56 bg-white shadow-lg rounded-b-lg border-t-2 border-blue-600 py-2">
                            <a href="#" onclick="app.router.navigate('list', 'reading')" class="block px-4 py-2 hover:bg-blue-50 text-sm text-gray-700">Academic Tests</a>
                            <a href="#" onclick="app.router.navigate('list', 'reading')" class="block px-4 py-2 hover:bg-blue-50 text-sm text-gray-700">General Training Tests</a>
                            <div class="border-t my-1"></div>
                            <a href="#" class="block px-4 py-2 hover:bg-blue-50 text-sm text-gray-700">Vocabulary List</a>
                        </div>
                    </div>

                    <!-- Writing Dropdown -->
                    <div class="relative group h-full flex items-center px-3">
                        <button class="text-gray-600 group-hover:text-blue-700 font-medium flex items-center gap-1 h-full">
                            Writing <i class="fa-solid fa-chevron-down text-[10px] opacity-50"></i>
                        </button>
                        <div class="hidden group-hover:block absolute top-16 left-0 w-56 bg-white shadow-lg rounded-b-lg border-t-2 border-blue-600 py-2">
                            <a href="#" onclick="app.router.navigate('list', 'writing')" class="block px-4 py-2 hover:bg-blue-50 text-sm text-gray-700">Task 1 (Academic)</a>
                            <a href="#" onclick="app.router.navigate('list', 'writing')" class="block px-4 py-2 hover:bg-blue-50 text-sm text-gray-700">Task 2 (Essay)</a>
                            <a href="#" class="block px-4 py-2 hover:bg-blue-50 text-sm text-gray-700">Evaluation Service</a>
                        </div>
                    </div>

                    <!-- Speaking Dropdown -->
                    <div class="relative group h-full flex items-center px-3">
                        <button class="text-gray-600 group-hover:text-blue-700 font-medium flex items-center gap-1 h-full">
                            Speaking <i class="fa-solid fa-chevron-down text-[10px] opacity-50"></i>
                        </button>
                        <div class="hidden group-hover:block absolute top-16 left-0 w-56 bg-white shadow-lg rounded-b-lg border-t-2 border-blue-600 py-2">
                            <a href="#" onclick="app.router.navigate('list', 'speaking')" class="block px-4 py-2 hover:bg-blue-50 text-sm text-gray-700">Full Mock Tests</a>
                            <a href="#" class="block px-4 py-2 hover:bg-blue-50 text-sm text-gray-700">Cue Card Topics 2024</a>
                            <a href="#" class="block px-4 py-2 hover:bg-blue-50 text-sm text-gray-700">Partner Finder</a>
                        </div>
                    </div>
                </div>

                <!-- Right Side User Menu -->
                <div class="hidden md:flex items-center space-x-4">
                    <!-- If NOT logged in -->
                    <div id="auth-guest" class="hidden">
                        <button class="text-gray-600 hover:text-gray-900 font-medium px-3" onclick="app.modal.open('login')">Log In</button>
                        <button class="bg-blue-700 hover:bg-blue-800 text-white px-5 py-2 rounded-full font-medium transition shadow-sm">Get Started</button>
                    </div>

                    <!-- If Logged in -->
                    <div id="auth-user" class="flex items-center gap-3">
                        <div class="text-right hidden lg:block">
                            <div class="text-sm font-bold text-gray-800">John Doe</div>
                            <div class="text-xs text-gray-500">Free Plan</div>
                        </div>
                        <button onclick="app.router.navigate('profile')" class="h-10 w-10 rounded-full bg-blue-100 text-blue-700 font-bold flex items-center justify-center hover:bg-blue-200 transition">
                            JD
                        </button>
                    </div>
                </div>
                
                 <!-- Mobile Menu Button -->
                 <div class="flex items-center md:hidden">
                    <button class="text-gray-500 hover:text-gray-700 p-2">
                        <i class="fa-solid fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>


    <!-- ================================================================================== -->
    <!-- MAIN CONTENT CONTAINER -->
    <!-- ================================================================================== -->
    <main class="flex-grow">

        {% block content %}
        {% endblock %}
        
    </main>

    <!-- ================================================================================== -->
    <!-- DJANGO TEMPLATE: base.html (FOOTER) -->
    <!-- ================================================================================== -->
    <footer class="bg-white border-t border-gray-200 mt-auto">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <span class="font-bold text-xl text-blue-900">IELTS<span class="text-blue-600">Pro</span></span>
                    <p class="text-sm text-gray-400 mt-1">Copyright &copy; 2024. All rights reserved.</p>
                </div>
                <div class="flex space-x-6">
                    <a href="#" class="text-gray-400 hover:text-gray-600"><i class="fa-brands fa-facebook"></i></a>
                    <a href="#" class="text-gray-400 hover:text-gray-600"><i class="fa-brands fa-twitter"></i></a>
                    <a href="#" class="text-gray-400 hover:text-gray-600"><i class="fa-brands fa-instagram"></i></a>
                </div>
            </div>
        </div>
    </footer>


    <!-- MODAL: LOGIN (Populate this via JS) -->
    <div id="modal-login" class="hidden fixed inset-0 z-[60] overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true" onclick="app.modal.close()"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4" id="modal-title">Log in to your account</h3>
                            <div class="space-y-4">
                                <input type="email" placeholder="Email address" class="w-full border rounded px-3 py-2">
                                <input type="password" placeholder="Password" class="w-full border rounded px-3 py-2">
                                <button onclick="app.modal.close(); app.router.navigate('profile');" class="w-full bg-blue-600 text-white font-bold py-2 rounded hover:bg-blue-700">Log In</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- APP LOGIC (Mocking Django Views) -->
    <script>
        const app = {
            data: {
                currentTestType: 'reading', // reading, listening, writing, speaking
                tests: [
                    { id: 1, type: 'reading', title: 'Cambridge 19 - Test 1', category: 'Academic', duration: '60m' },
                    { id: 2, type: 'reading', title: 'Cambridge 19 - Test 2', category: 'Academic', duration: '60m' },
                    { id: 3, type: 'listening', title: 'Listening Vol 4 - Test 1', category: 'General', duration: '30m' },
                    { id: 4, type: 'writing', title: 'Task 2: Education', category: 'Academic', duration: '40m' },
                    { id: 5, type: 'speaking', title: 'Part 2 Cue Card: Hobbies', category: 'All', duration: '15m' },
                ]
            },

            router: {
                navigate: function(viewId, param = null) {
                    // Hide all views
                    document.querySelectorAll('.page-view').forEach(el => {
                        el.classList.add('hidden');
                        el.classList.remove('block');
                    });

                    // Handle params (like context data in Django)
                    if (viewId === 'list' && param) {
                        app.data.currentTestType = param;
                        app.renderer.renderList(param);
                    }
                    if (viewId === 'exam') {
                        app.renderer.setupExam(app.data.currentTestType);
                    }

                    // Show target view
                    const target = document.getElementById(`view-${viewId}`);
                    if(target) {
                        target.classList.remove('hidden');
                        target.classList.add('block');
                        window.scrollTo(0,0);
                    }
                }
            },

            renderer: {
                // Mimics Django ListView
                renderList: function(type) {
                    document.getElementById('list-title').textContent = type.charAt(0).toUpperCase() + type.slice(1) + " Tests Library";
                    
                    const grid = document.getElementById('test-grid');
                    grid.innerHTML = ''; // Clear

                    // Filter dummy data
                    const filtered = app.data.tests.filter(t => t.type === type || t.type === 'all');
                    
                    // Fallback if no specific dummy data
                    const items = filtered.length ? filtered : app.data.tests.slice(0,3); 

                    items.forEach(test => {
                        const colorClass = type === 'reading' ? 'blue' : (type === 'listening' ? 'red' : (type === 'writing' ? 'yellow' : 'green'));
                        const html = `
                            <div class="bg-white rounded-lg shadow-sm hover:shadow-md transition border border-gray-100 flex flex-col">
                                <div class="p-6 flex-grow">
                                    <div class="flex justify-between items-start mb-4">
                                        <span class="px-2 py-1 bg-${colorClass}-100 text-${colorClass}-800 text-xs rounded font-bold uppercase">${test.category}</span>
                                        <span class="text-gray-400 text-xs"><i class="fa-regular fa-clock"></i> ${test.duration}</span>
                                    </div>
                                    <h3 class="font-bold text-gray-800 text-lg mb-2">${test.title}</h3>
                                    <p class="text-gray-500 text-sm">Real exam simulation with instant band score evaluation.</p>
                                </div>
                                <div class="p-4 border-t border-gray-50 bg-gray-50 rounded-b-lg">
                                    <button onclick="app.router.navigate('exam')" class="w-full bg-white border border-${colorClass}-500 text-${colorClass}-600 font-bold py-2 rounded hover:bg-${colorClass}-50 transition">
                                        Take Test
                                    </button>
                                </div>
                            </div>
                        `;
                        grid.innerHTML += html;
                    });
                },

                // Sets up the Exam Interface based on type (Reading vs Listening vs Writing)
                setupExam: function(type) {
                    const leftPane = document.getElementById('pane-left');
                    const rightPane = document.getElementById('pane-right');
                    
                    // Reset visibility
                    document.getElementById('content-reading').classList.add('hidden');
                    document.getElementById('content-writing').classList.add('hidden');
                    document.getElementById('content-speaking').classList.add('hidden');
                    document.getElementById('inputs-standard').classList.add('hidden');
                    document.getElementById('inputs-writing').classList.add('hidden');
                    document.getElementById('exam-audio-player').classList.add('hidden');

                    // Reset widths (Writing/Speaking might need different layout)
                    leftPane.className = "w-1/2 overflow-y-auto test-scroll p-8 border-r bg-white";
                    rightPane.className = "w-1/2 overflow-y-auto test-scroll bg-gray-50 p-8";

                    if (type === 'reading') {
                        document.getElementById('content-reading').classList.remove('hidden');
                        document.getElementById('inputs-standard').classList.remove('hidden');
                        document.getElementById('exam-header-title').textContent = "Reading Practice Test";
                    } 
                    else if (type === 'listening') {
                        document.getElementById('exam-audio-player').classList.remove('hidden');
                        document.getElementById('inputs-standard').classList.remove('hidden');
                        // Listening usually doesn't have a text passage on left, maybe questions on both sides or map on left
                        // For demo, we keep standard input on right, map placeholder on left
                        document.getElementById('content-reading').classList.remove('hidden'); 
                        document.getElementById('exam-header-title').textContent = "Listening Practice Test";
                    }
                    else if (type === 'writing') {
                        document.getElementById('content-writing').classList.remove('hidden');
                        document.getElementById('inputs-writing').classList.remove('hidden');
                        document.getElementById('exam-header-title').textContent = "Writing Practice Test";
                    }
                    else if (type === 'speaking') {
                        // Speaking is usually centered prompt
                        leftPane.className = "w-full overflow-y-auto test-scroll p-8 bg-white flex flex-col items-center justify-center";
                        rightPane.className = "hidden";
                        document.getElementById('content-speaking').classList.remove('hidden');
                        document.getElementById('exam-header-title').textContent = "Speaking Practice Test";
                    }
                }
            },

            modal: {
                open: function(id) {
                    document.getElementById(`modal-${id}`).classList.remove('hidden');
                },
                close: function() {
                    document.querySelectorAll('[id^="modal-"]').forEach(el => el.classList.add('hidden'));
                }
            }
        };

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            app.router.navigate('home');
        });
    </script>
</body>
</html>